<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>2022 April 100 onboard - The 0L Developer Book</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Mission</a></li><li class="chapter-item expanded affix "><li class="part-title">0L Technology Participants</li><li class="chapter-item expanded "><a href="../tech_participants/carpe_miners.html"><strong aria-hidden="true">1.</strong> carpe miners</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> nodes</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tech_participants/validators.html"><strong aria-hidden="true">2.1.</strong> validators</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tech_participants/validator_onboarding.html"><strong aria-hidden="true">2.1.1.</strong> onboarding</a></li><li class="chapter-item expanded "><a href="../tech_participants/validator_backup.html"><strong aria-hidden="true">2.1.2.</strong> backing up</a></li></ol></li><li class="chapter-item expanded "><a href="../tech_participants/fullnodes.html"><strong aria-hidden="true">2.2.</strong> fullnodes</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Developer Guide</li><li class="chapter-item expanded "><a href="../developer_guide/libra_core/index.html"><strong aria-hidden="true">3.</strong> libra-core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/libra_core/diem-node.html"><strong aria-hidden="true">3.1.</strong> diem-node</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/libra_core/diem-node_config.html"><strong aria-hidden="true">3.1.1.</strong> config</a></li></ol></li><li class="chapter-item expanded "><a href="../developer_guide/libra_core/consensus.html"><strong aria-hidden="true">3.2.</strong> consensus</a></li><li class="chapter-item expanded "><a href="../developer_guide/libra_core/language.html"><strong aria-hidden="true">3.3.</strong> lanaguage move</a></li></ol></li><li class="chapter-item expanded "><a href="../developer_guide/move/index.html"><strong aria-hidden="true">4.</strong> move</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/move/move_stdlib.html"><strong aria-hidden="true">4.1.</strong> move stdlib</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/move/move_stdlib_makechanges.html"><strong aria-hidden="true">4.1.1.</strong> make changes</a></li><li class="chapter-item expanded "><a href="../developer_guide/move/move_stdlib_hotupgrades.html"><strong aria-hidden="true">4.1.2.</strong> hot upgrades</a></li><li class="chapter-item expanded "><a href="../developer_guide/move/move_stdlib_test.html"><strong aria-hidden="true">4.1.3.</strong> test stdlib</a></li></ol></li><li class="chapter-item expanded "><a href="../developer_guide/move/hello_world_move_mod.html"><strong aria-hidden="true">4.2.</strong> &quot;Hello, World!&quot; move module</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/move/deploy_smartcontract.html"><strong aria-hidden="true">4.2.1.</strong> deploying</a></li><li class="chapter-item expanded "><a href="../developer_guide/move/interact_with_smartcontract.html"><strong aria-hidden="true">4.2.2.</strong> interacting</a></li><li class="chapter-item expanded "><a href="../developer_guide/move/FAQ.html"><strong aria-hidden="true">4.2.3.</strong> FAQ</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../developer_guide/carpe/index.html"><strong aria-hidden="true">5.</strong> carpe</a></li><li class="chapter-item expanded "><a href="../developer_guide/bridge/index.html"><strong aria-hidden="true">6.</strong> bridge</a></li><li class="chapter-item expanded "><a href="../developer_guide/testnet/index.html"><strong aria-hidden="true">7.</strong> testnet</a></li><li class="chapter-item expanded "><a href="../developer_guide/ops/index.html"><strong aria-hidden="true">8.</strong> operations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developer_guide/ops/error_codes.html"><strong aria-hidden="true">8.1.</strong> error codes</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Network Rescues</li><li class="chapter-item expanded "><a href="../network_rescue/2022_april.html" class="active"><strong aria-hidden="true">9.</strong> 2022 April 100 onboard</a></li><li class="chapter-item expanded affix "><li class="part-title">Get Involved</li><li class="chapter-item expanded "><a href="../wg/index.html"><strong aria-hidden="true">10.</strong> Working Groups</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../wg/eng_wg.html"><strong aria-hidden="true">10.1.</strong> engineering-wg</a></li><li class="chapter-item expanded "><a href="../wg/gov_wg.html"><strong aria-hidden="true">10.2.</strong> governance-wg</a></li><li class="chapter-item expanded "><a href="../wg/analytics_wg.html"><strong aria-hidden="true">10.3.</strong> analytics-wg</a></li><li class="chapter-item expanded "><a href="../wg/brand_and_commons_wg.html"><strong aria-hidden="true">10.4.</strong> branding-and-commons-wg</a></li><li class="chapter-item expanded "><a href="../wg/coordinators_wg.html"><strong aria-hidden="true">10.5.</strong> coordinators-wg</a></li></ol></li><li class="chapter-item expanded "><a href="../wg/index.html"><strong aria-hidden="true">11.</strong> Hustle Karma</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">12.</strong> Appendix</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../keyword_acronyms.html"><strong aria-hidden="true">12.1.</strong> Keywords / Acronyms</a></li><li class="chapter-item expanded "><a href="../FAQ.html"><strong aria-hidden="true">12.2.</strong> FAQ</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The 0L Developer Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="2022-april-100-onboard"><a class="header" href="#2022-april-100-onboard">2022 April 100 onboard</a></h1>
<h2 id="what-happened"><a class="header" href="#what-happened">What Happened?</a></h2>
<p>Validators were failing and around epoch 165 fewer than 4 validators that were eligible to make it into the next epoch, 
this triggered a conditional in the 
<a href="https://github.com/OLSF/libra/blob/820ec66f3457fb26a4e24c952407d37f05ce6b1c/language/diem-framework/modules/0L/EpochBoundary.move#L148-L156">on chain move library EpochBoundry.move</a><br />
that contained a bug: instead of keeping the same validator set from the previous epoch, the <code>top_accounts</code>, capped at 100 
validators, made it to the next epoch 167. Out of the 100 validators in the new epoch, some were seemingly
not actively maintained and were unknown entities with no means of contacting the operators. </p>
<p>Attempt 1 (11 April 2022 4pm EST): There was a coordinated restart of the network done during a validator discord call. 
The validators on the call did a synchronized restart of the nodes they controlled and many 
validators set a <a href="https://github.com/OLSF/libra/blob/validator-autorestart-doc/ol/documentation/node-ops/auto_restart_validators.md">cron job to restart their validator every 1 hour</a>. 
It was requested that validator turn off towers and fullnodes
and only run their validators.<br />
Blocks started to be produced, albeit slower than normal, and occationally block production would be halted.</p>
<p>Next a <strong><a href="https://hackmd.io/8pNAlRk-TpypCgQVQGWHzw">detailed plan</a></strong> was outlined as to what next steps could be taken to recover the network.</p>
<blockquote>
<p>Plan A: Organize a Synchronous start with the 100 validators in the network.</p>
</blockquote>
<blockquote>
<p>Plan B: Issue a manual writeset transaction to overwrite the validator set to approx 10 validators, with no state change. (soft fork)</p>
</blockquote>
<blockquote>
<p>Plan C: Scorched earth state dump and overwrite validator set (approx 10), preserving only balances, tower-state, and validator configs.</p>
</blockquote>
<p>Eagle Network 15 April 2022 launched as a test network for a reconfigured validator set. </p>
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<ul>
<li><a href="https://hackmd.io/8pNAlRk-TpypCgQVQGWHzw">2022 Apirl 13th POA / Call to action</a></li>
<li><a href="https://docs.google.com/spreadsheets/d/1T8-TzSQvICk3Q49ooGUxTACeE4_BZRnnBdxSIM-67Cw/edit#gid=0">epoch 168 validators</a></li>
<li><a href="https://docs.google.com/spreadsheets/d/1QRal4-LLuDZIiLyMsMV_2_nteuNc4avuykoPWg6Od_g/edit#gid=1546165814">11th April validator coordinated restart</a></li>
<li><a href="https://raw.githubusercontent.com/OLSF/seed-peers/main/fullnode_seed_playlist.json">fullnode seed playlist</a></li>
<li><a href="https://github.com/OLSF/epoch-archive/blob/main/Makefile">epoch-archive</a></li>
<li><a href="https://github.com/OLSF/libra/blob/rescue-mission/ol/documentation/network-upgrades/disaster-recovery.md">disaster-recovery doc - update db, update stdlib</a></li>
</ul>
<h2 id="related-github-issues"><a class="header" href="#related-github-issues">Related Github Issues</a></h2>
<ul>
<li><a href="https://github.com/OLSF/libra/issues/1066">Only increase validator sets by at most 25% between epochs 1066</a> </li>
</ul>
<h2 id="rescue-mission-branch-and-docs"><a class="header" href="#rescue-mission-branch-and-docs">Rescue Mission Branch and Docs</a></h2>
<ul>
<li><a href="https://github.com/OLSF/libra/blob/rescue-mission/ol/documentation/network-upgrades/disaster-recovery.md">Plan B - Manual Overrides to State</a></li>
<li><a href="https://github.com/OLSF/libra/blob/rescue-mission/language/diem-tools/writeset-transaction-generator/Makefile">writeset-transaction-generator Makefile</a></li>
<li><a href="https://github.com/OLSF/libra/pull/1071">Network Recovery Tools</a></li>
</ul>
<h2 id="debug-commands--endpoints"><a class="header" href="#debug-commands--endpoints">Debug Commands / endpoints</a></h2>
<ul>
<li><a href="https://github.com/OLSF/libra/blob/validator-autorestart-doc/ol/documentation/node-ops/auto_restart_validators.md">set cron job to restart validators every hour</a></li>
<li>web server: obtain validator's IPs via the web monitor -&gt; validators -&gt; click on <code>(i)</code> icon next to the validator IP, check if reachable on port.</li>
</ul>
<pre><code class="language-console">$ nc -zv $IP 6180
</code></pre>
<ul>
<li>web server: vital endpoint http://$IP:3030/vitals</li>
<li><a href="https://github.com/OLSF/epoch-archive#backup-cli"><code>backup-cli</code></a>:
<ol>
<li><code>db-backup</code> tool <a href="https://github.com/diem/diem/blob/main/specifications/db_backup/spec.md">DiemDB Backup</a></li>
<li><code>db-restore</code> tool</li>
</ol>
</li>
<li><code>db-bootstrapper</code><br />
apply the writeset to the database <code>cargo r -p db-bootstrapper -- ~/.0L/db/ --genesis-txn-file ~/.0L/restore/rescue.blob</code> </li>
<li><code>diem-transaction-replay</code>: inspect state of db.<br />
export the 0x0 state to file for easy viewing:<br />
<code>cargo r -p diem-transaction-replay -- --db ~/.0L/db annotate-account 00000000000000000000000000000000 &gt; ~/.0L/dump-a sha256sum ~/.0L/dump-a</code></li>
<li><code> diem-writeset-generator</code>: create tx binaries and save the files (files applied later, e.g. via <code>db-bootstrapper</code>)</li>
<li>try reconfig event: <code>cargo r -p diem-writeset-generator -- --output ~/.0L/restore/rescue.blob reconfig ~/.0L/db</code></li>
<li>try stdlib update: <code>cargo r -p diem-writeset-generator -- --output ~/.0L/restore/rescue.blob update-stdlib ~/.0L/db</code></li>
<li><code>ol/genesis-tool</code></li>
<li><a href="https://github.com/OLSF/libra/blob/main/execution/db-bootstrapper/src/bin/db-bootstrapper.rs"><code>db-bootstrapper</code></a>: 
typically used to create genesis file, can be used to apply writeset to a database at rest (halted network).</li>
</ul>
<h2 id="relevant-code"><a class="header" href="#relevant-code">Relevant code</a></h2>
<ul>
<li>
<p><a href="https://github.com/OLSF/libra/issues/1063">BUG: Validator failover not implemented to spec</a></p>
</li>
<li>
<p><a href="https://github.com/OLSF/libra/blob/820ec66f3457fb26a4e24c952407d37f05ce6b1c/language/diem-framework/modules/0L/EpochBoundary.move#L148-L156">Epoch Boundry Val Selection</a></p>
</li>
<li>
<p><a href="https://github.com/OLSF/libra/blob/0b2f2901616bdf243151367d8e31f966d0280c1f/ol/genesis-tools/src/fork_genesis.rs">genesis tool: Fork Genesis</a></p>
</li>
<li>
<p><a href="https://github.com/OLSF/libra/blob/4d4a60f5dfe33b8121d97e46c67f77e6fe28b745/ol/genesis-tools/src/process_snapshot.rs">genesis tool: process snapshot</a></p>
</li>
<li>
<p><a href="https://github.com/OLSF/libra/pull/1071">PR Network Recovery Tools</a></p>
</li>
</ul>
<h2 id="backup--snapshot-information"><a class="header" href="#backup--snapshot-information">Backup / Snapshot Information</a></h2>
<p>https://github.com/OLSF/epoch-archive/blob/main/165/transaction_37230877-.2066/transaction.manifest</p>
<blockquote>
<p>There are 3 different components to a backup so that a db can be &quot;bootstrapped&quot; and understandable by the diem-node .<br />
Epoch is meta information on the Epoch.<br />
State Snapshot is the state of the blockchain.<br />
Transactions are a history of txs.<br />
To bootstrap a working DB you need at least 1 tx. That's why we only put one for the purposes of epoch-archive.</p>
</blockquote>
<p><a href="https://github.com/OLSF/epoch-archive">epoch-archive README.md</a></p>
<blockquote>
<p>Backups are a way of bootstrapping the DB. There are 3 types of point-in-time backups:</p>
<p>Epoch Ending<br />
Transactions<br />
State Snapshot<br />
<strong>All three types of backups are needed to restore and bootstrap a database.</strong></p>
</blockquote>
<p>steps taken from <a href="https://github.com/OLSF/epoch-archive/blob/main/Makefile#L74">epoch-archive/MAKEFILE</a><br />
build backup-cli:<br />
<strong>note</strong> your SOURCE_PATH should be set to your libra project dir. </p>
<pre><code class="language-console">$ export SOURCE_PATH=~/libra
$ cd $SOURCE_PATH
$ cargo build -p backup-cli --release
$ cp -f ${SOURCE_PATH}/target/release/db-restore /usr/local/bin/db-restore
$ cp -f ${SOURCE_PATH}/target/release/db-backup /usr/local/bin/db-backup
</code></pre>
<h3 id="snapshot-issue"><a class="header" href="#snapshot-issue">Snapshot issue</a></h3>
<p>@Abed</p>
<pre><code>2022-04-16T14:07:36.417448Z [main] INFO storage/backup/backup-cli/src/backup_types/state_snapshot/backup.rs:58 State snapshot backup started, for version 30189516.
2022-04-16T14:07:36.424378Z [main] ERROR storage/backup/backup-cli/src/utils/error_notes.rs:14 Error raised, see notes. {&quot;error&quot;:&quot;request or response body error: error reading a body from connection: unexpected EOF during chunk size line&quot;,&quot;notes&quot;:&quot;\&quot;\&quot;&quot;}
2022-04-16T14:07:36.425423Z [main] ERROR storage/backup/backup-cli/src/bin/db-backup.rs:130 main_impl() failed: State snapshot backup failed: request or response body error: error reading a body from connection: unexpected EOF during chunk size line
Error: State snapshot backup failed: request or response body error: error reading a body from connection: unexpected EOF during chunk size line
</code></pre>
<p>@OD
I think it's because your state has be &quot;pruned&quot;
In node.yaml there is a prune_window field measured in blocks. So your prune window is smaller than the length of an 
epoch. So the db-tool can't find anything beyond
node/fullnode.yaml</p>
<pre><code class="language-yaml">...
storage:
address: &quot;127.0.0.1:6666&quot;
backup_service_address: &quot;127.0.0.1:6186&quot;
dir: db
grpc_max_receive_len: 100000000
prune_window: 20000
timeout_ms: 30000
...
</code></pre>
<h3 id="hot-stepper-uppers"><a class="header" href="#hot-stepper-uppers">Hot Stepper Uppers</a></h3>
<p>@Od - main debugging, code diving, solution propositions<br />
@gnudrew25 - db dump https://home.gouin.io:5443/0L.167.tar.xz<br />
71G  0L.167.tar.xz
extracted
70G  	./db/diemdb
753M	./db/consensusdb</p>
<p>@shashank @jamesm - move code<br />
@Ping | ping.pub - tooling for flashing the stdlib<br />
@Barmaley<br />
@Adal - modifiying web app to expose ports<br />
@Abed - working with backup / snapshots
@Daniyal
@drawks</p>
<h3 id="lessons-learned"><a class="header" href="#lessons-learned">Lessons Learned</a></h3>
<ul>
<li>Getting 100 validator to coordinate is hard.</li>
<li>No great way to contact validators. Validator contact info could be required in config? Maybe discord name, email or preferred contact.</li>
<li>Validators that are not active but have accumulated high voting power will potentially kick active validator out of the proposed validator set. </li>
<li>Full network archive 70G</li>
</ul>
<h2 id="root-cause-analysis"><a class="header" href="#root-cause-analysis">Root Cause Analysis</a></h2>
<p>@mortonbits
I was looking into the move code and have an assumption of what might have caused those &quot;consensus troubles&quot;. I am not 
a blockchain or move language hero, but just from looking to the following piece of code from a software 
architecture perspective is something, that would not even be good on a multi threaded environment. So I am doubting 
strongly it will be a good pattern in a distributed ledger and maybe it was only luck that the network kept running for 
the recent period.</p>
<p>Basically what I suspect is the usage of the counters of tower proofs submitted. It is a data structure that - in old s
chool programming - could be called a global variable. It is increased at each submit of a proof. 
It looks as follows (<a href="https://github.com/OLSF/libra/blob/main/language/diem-framework/modules/0L/TowerState.move#L480-L481">language/diem-framework/modules/0L/TowerState.move</a>) :</p>
<p>state.fullnode_proofs_in_epoch = state.fullnode_proofs_in_epoch + 1;
state.lifetime_fullnode_proofs = state.lifetime_fullnode_proofs + 1;
.
.
.
state.proofs_in_epoch = state.proofs_in_epoch + 1;
state.lifetime_proofs = state.lifetime_proofs + 1;</p>
<p>Now - if proofs are submitted frequently and more or less simultaneously to different validators, how can  the network know, 
which new state is the right one? Maybe someone can prove me wrong, but I lack the imagination, how this should work reliably.</p>
<p>(btw: a fix could be to make this summation at epoch boundary or whenever needed over all towers. Would be slower, 
but read-only and thus fail save)</p>
<h2 id="todos-this-will-be-updated-until-block-morale-improves"><a class="header" href="#todos-this-will-be-updated-until-block-morale-improves">TODOs (this will be updated until block morale improves)</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
We need a way to get a snapshot of an exact block height. See some info here: https://github.com/OLSF/epoch-archive
https://github.com/OLSF/epoch-archive
Correct failover issue in Move https://github.com/OLSF/libra/pull/1069/ @jamesm</li>
<li><input disabled="" type="checkbox"/>
Find db-backup db-restore sequence to share an archive between validators (volunteers?)</li>
<li><input disabled="" type="checkbox"/>
Code rust tools for write set generation @0D | 0o-de-lally</li>
<li><input disabled="" type="checkbox"/>
Code writeset for incrementing timestamp @Ping | ping.pub</li>
<li><input disabled="" type="checkbox"/>
Debug MoveVM cache not being invalidated @shb</li>
<li><input disabled="" type="checkbox"/>
Test block production in Eagle network @0D | 0o-de-lally</li>
<li><input disabled="" type="checkbox"/>
Test tower submission on Eagle @0D | 0o-de-lally</li>
<li><input disabled="" type="checkbox"/>
(Maybe) Change seat rotation algo  https://github.com/OLSF/libra/issues/1066 @shashank @keerthi</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../developer_guide/ops/error_codes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../wg/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../developer_guide/ops/error_codes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../wg/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
